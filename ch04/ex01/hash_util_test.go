// Copyright 2017 Ken Mirua
package main

import "testing"

var tests = []struct {
	input1   [32]byte
	input2   [32]byte
	expected int
}{
	{[32]byte{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, [32]byte{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 0},
	{ /* xのsha256 */ [32]byte{0x2D, 0x71, 0x16, 0x42, 0xB7, 0x26, 0xB0, 0x44, 0x01, 0x62, 0x7C, 0xA9, 0xFB, 0xAC, 0x32, 0xF5, 0xC8, 0x53, 0x0F, 0xB1, 0x90, 0x3C, 0xC4, 0xDB, 0x02, 0x25, 0x87, 0x17, 0x92, 0x1A, 0x48, 0x81} /* Xのsha256 */, [32]byte{0x4B, 0x68, 0xAB, 0x38, 0x47, 0xFE, 0xDA, 0x7D, 0x6C, 0x62, 0xC1, 0xFB, 0xCB, 0xEE, 0xBF, 0xA3, 0x5E, 0xAB, 0x73, 0x51, 0xED, 0x5E, 0x78, 0xF4, 0xDD, 0xAD, 0xEA, 0x5D, 0xF6, 0x4B, 0x80, 0x15}, 125},
}

func TestCountDifferencesBetweenTwoSHA256Messages(t *testing.T) {
	for _, tt := range tests {
		actual := CountDifferencesBetweenTwoSHA256Messages(tt.input1, tt.input2)
		if actual != tt.expected {
			t.Fatalf("expected is %d, but actual is %d (input1: %v, input2: %v)", tt.expected, actual, tt.input1, tt.input2)
		}
	}
}
